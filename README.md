# 高铁站能耗监控演示系统

## 项目概述

基于 React 17 + Ant Design 4 + TypeScript 4.9 + ECharts 5 构建的高铁站能耗监控演示系统，实现纯前端仿真、权限控制、数据可视化等完整功能。

## 技术栈

- **前端框架**：React 17.0.2
- **UI 组件库**：Ant Design 4.24.15
- **类型系统**：TypeScript 4.9
- **图表库**：ECharts 5.4.3
- **构建工具**：Vite 6.0.5
- **状态管理**：Zustand (轻量级)
- **路由**：React Router v6
- **日期处理**：Moment.js 2.29.4

## 功能模块

### 1. 用户认证与权限
- ✅ 登录/登出功能
- ✅ RBAC 权限模型（5种角色：super_admin, admin, operator, viewer, auditor）
- ✅ 路由守卫与菜单权限控制
- ✅ 按钮级权限控制
- ✅ LocalStorage 持久化登录状态

### 2. 首页（Dashboard）
- ✅ 全局概览卡片（总能耗、单位面积能耗、能耗成本、能源效率）
- ✅ 高级筛选（车站类型、能耗等级、时间范围）
- ✅ 筛选条件 LocalStorage 记忆
- ✅ 视图切换（单站看板/多站仪表盘）
- ✅ AI 汇总分析（节能潜力、趋势分析）
- ✅ 能耗/成本/效率趋势图（ECharts）
- ✅ 预警信息汇总
- ✅ 数据导出（CSV）

### 3. 单站能耗分析
- ✅ 多维度筛选（车站、时间范围、粒度、预测天数）
- ✅ 筛选驱动数据更新
- ✅ 能耗/成本/效率趋势图（含预测曲线：实线/虚线）
- ✅ 设备类型能耗占比饼图
- ✅ 部门能耗对比柱状图
- ✅ 异常记录列表（筛选、排序）
- ✅ 异常详情弹窗（完整信息+处理建议）
- ✅ 异常状态流转（未处理→已处理）
- ✅ CSV 导出

### 4. 能耗占比分析
- ✅ 多维度筛选（关键词、日期范围、能耗类型）
- ✅ 四维度饼图（按区域/设备类型/时段/能耗类型）
- ✅ 堆叠面积趋势图
- ✅ 详细数据表格（排序、分页）
- ✅ 数值格式化显示
- ✅ CSV 导出

### 5. 能耗分析预警
- ✅ 预警概览卡片（总数、高危、中危、待处理）
- ✅ 预警等级分布饼图
- ✅ 预警趋势折线图
- ✅ 预警列表（筛选、排序、分页）
- ✅ 状态流转（未处理→处理中→已解决）
- ✅ 批量操作（批量标记处理/解决）
- ✅ 详情弹窗
- ✅ CSV 导出

### 6. 多站能耗对比
- ✅ 多站点选择（最多6个）
- ✅ 时间范围与能源类型筛选
- ✅ 总能耗柱状图对比
- ✅ 能耗趋势折线图对比
- ✅ 排名表（支持排序）
- ✅ 能效等级标识
- ✅ CSV 导出

### 7. 节能策略模拟
- ✅ 智能策略推荐（匹配度评分）
- ✅ 策略模板管理（基础/综合/快速回本方案）
- ✅ 策略组合功能
- ✅ 组合效果统计（节能率、投资、回本期）
- ✅ 模拟执行
- ✅ 历史记录查询

### 8. 设备管理
- ✅ 系统列表 CRUD
- ✅ 筛选与搜索
- ✅ 能耗趋势图
- ✅ 能耗占比饼图
- ✅ CSV 导出
- ✅ 维护/预警/报表入口（占位）

### 9. 系统管理
- ✅ 系统概览（资源使用趋势）
- ✅ 用户管理（列表、状态切换）
- ✅ 角色管理（列表、权限树）
- ✅ 菜单管理（树形结构、CRUD）
- ✅ 权限矩阵（角色-菜单权限映射）
- ✅ 系统设置（主题、语言、刷新间隔等）
- ✅ 操作日志（筛选、导出）

## 设计规范

### 全局 Design Tokens
- **色彩系统**：主色 #1890ff、辅助色 #722ed1、成功 #52c41a、警告 #faad14、错误 #f5222d
- **间距系统**：xs(4px)、sm(8px)、md(16px)、lg(24px)、xl(32px)
- **圆角系统**：sm(2px)、md(4px)、lg(8px)、xl(12px)
- **阴影系统**：sm/md/lg/xl 四级阴影
- **字体系统**：Inter 字体族，xs(12px)、sm(14px)、base(14px)、lg(16px)、xl(20px)、xxl(24px)

### 组件规范
- 所有卡片统一圆角 8px、阴影 0 2px 8px rgba(0,0,0,0.09)
- 按钮 hover 上移 1px + 阴影
- 表格行 hover 背景 #e6f7ff
- 输入框 focus 边框色 #1890ff + 外阴影
- Tag 圆角 4px、无边框

### 图表主题
- 统一色板：8色渐变（主色系）
- 统一字体：Inter 14px
- 统一 tooltip 样式：黑底白字、圆角 4px
- 统一图例样式：12px 方块、16px 间距
- 统一网格线：#f0f0f0 虚线

## 数据仿真

### LocalStorage 持久化
- 用户登录状态（token + roleKey）
- 首页筛选条件
- 系统设置
- 用户/角色/菜单数据（CRUD 操作同步更新）

### Mock 数据特性
- 所有 API 请求模拟 300-800ms 延迟
- 数据随机生成（基于筛选条件）
- 状态流转逻辑完整
- 支持 CRUD 操作
- 支持筛选、排序、分页

## 启动说明

### 安装依赖
```bash
cd app
npm install
```

### 开发模式
```bash
npm run dev
```
访问 `http://localhost:5173`

### 构建生产版本
```bash
npm run build
```

### 预览生产版本
```bash
npm run preview
```

## 测试账号

| 角色 | 用户名 | 密码 | 权限说明 |
|------|--------|------|----------|
| 超级管理员 | admin | admin123 | 全部权限 |
| 管理员 | manager | manager123 | 管理权限（无系统设置） |
| 操作员 | operator | operator123 | 数据录入与编辑 |
| 查看员 | viewer | viewer123 | 仅查看权限 |
| 审计员 | auditor | auditor123 | 日志查看权限 |

## 目录结构

```
app/
├── src/
│   ├── components/          # 通用组件
│   │   ├── Authorized.tsx   # 权限控制组件
│   │   ├── Chart.tsx        # ECharts 封装
│   │   ├── PageHeader.tsx   # 页面头部
│   │   └── StateComponents.tsx  # 状态组件（Loading/Empty/Error）
│   ├── layouts/             # 布局组件
│   │   └── MainLayout.tsx   # 主布局（侧边栏+顶栏+内容区）
│   ├── pages/               # 页面组件
│   │   ├── auth/            # 认证页面
│   │   ├── dashboard/       # 首页
│   │   ├── analysis/        # 分析模块
│   │   ├── alerts/          # 预警模块
│   │   ├── compare/         # 对比模块
│   │   ├── strategy/        # 策略模块
│   │   ├── device/          # 设备模块
│   │   └── system/          # 系统管理
│   ├── stores/              # 状态管理
│   │   ├── auth.ts          # 认证状态
│   │   └── ui.ts            # UI 状态
│   ├── mock/                # Mock 数据
│   │   ├── data.ts          # 模拟数据
│   │   └── menu.tsx         # 菜单配置
│   ├── utils/               # 工具函数
│   │   ├── mock.ts          # Mock 工具
│   │   └── chartTheme.ts    # 图表主题
│   ├── styles/              # 全局样式
│   │   └── theme.css        # Design Tokens
│   ├── router.tsx           # 路由配置
│   └── main.tsx             # 入口文件
├── tests/                   # 测试文件
│   └── e2e/                 # E2E 测试
│       └── basic.spec.ts    # 基础功能测试
├── package.json
├── tsconfig.json
├── vite.config.ts
└── README.md
```

## 核心特性

### 1. 纯前端仿真
- 无需后端服务器
- LocalStorage 模拟数据库
- 完整的 CRUD 逻辑
- 数据持久化（刷新不丢失）

### 2. 权限控制
- 基于 RBAC 的权限模型
- 路由级权限守卫
- 菜单级权限过滤
- 按钮级权限控制（Authorized 组件）

### 3. 数据可视化
- ECharts 5 图表库
- 统一主题配置
- 响应式图表
- 交互式 tooltip
- 数据下钻支持

### 4. 用户体验
- Loading 状态提示
- Empty 空态提示
- Error 错误处理
- 操作成功/失败反馈
- 数据导出功能
- 筛选条件记忆

### 5. 代码质量
- TypeScript 类型安全
- 组件化开发
- 注释率 ≥ 30%
- ESLint 代码规范
- 模块化拆分

## 浏览器兼容性

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## 开发规范

### 命名规范
- 组件：PascalCase（如 `PageHeader.tsx`）
- 文件夹：camelCase（如 `dashboard/`）
- 函数：camelCase（如 `handleQuery`）
- 常量：UPPER_SNAKE_CASE（如 `BASE_URL`）

### 代码规范
- 函数行数 ≤ 80 行
- 注释率 ≥ 30%
- 单一职责原则
- 避免深层嵌套（≤ 3层）

### Git 提交规范
- `feat`: 新功能
- `fix`: 修复 bug
- `docs`: 文档更新
- `style`: 代码格式调整
- `refactor`: 重构
- `test`: 测试相关
- `chore`: 构建/工具相关

## 已知问题

1. ~~开发服务器启动问题~~（已修复：PowerShell `&&` 语法问题）
2. 部分页面需进一步对齐 Figma 设计稿
3. Playwright E2E 测试需手动执行
4. 暗色主题切换功能待开发

## 后续优化

1. 完善暗色主题支持
2. 添加更多图表类型
3. 优化移动端适配
4. 添加数据导入功能
5. 完善 Playwright 测试覆盖
6. 添加性能监控
7. 优化首屏加载速度
8. 添加国际化支持

## 联系方式

如有问题或建议，请联系开发团队。

---

**版本**: 1.0.0  
**最后更新**: 2026-01-04  
**开发状态**: ✅ 核心功能已完成
