# 首页功能设计文档

UI设计地址：https://www.figma.com/design/k5TBKzoZJ0DPn5LobyEc20/%E9%AB%98%E9%93%81%E7%AB%99%E8%83%BD%E8%80%97%E6%BC%94%E7%A4%BA?node-id=34-2&m=dev

## 1. 功能概述

### 1.1 功能定位
首页是高铁站节能降耗演示系统的核心门户，为用户提供全局能耗数据概览、AI智能分析汇总、实时监控数据展示以及快速访问各功能模块的统一入口。

### 1.2 核心价值
- **数据可视化**：通过图表直观展示系统整体能耗状况
- **AI智能分析**：基于时间与站点维度的智能能耗分析汇总
- **快速导航**：提供快速访问各功能模块的便捷入口
- **实时监控**：实时展示系统关键指标和预警信息
- **个性化配置**：支持用户个性化设置和主题切换

## 2. 功能架构

### 2.1 主要功能模块
```
首页功能架构
├── 页面头部区域
│   ├── 系统标题和Logo展示
│   ├── 场景标签显示
│   └── 功能操作按钮组
├── 高级筛选区域
│   ├── 车站类型筛选
│   ├── 能耗等级筛选
│   ├── 时间范围选择
│   └── 应用/重置按钮
├── 视图切换器
│   ├── 单站看板视图
│   └── 多站仪表盘视图
├── AI汇总分析模块
│   ├── 分析时间范围选择
│   ├── 站点多选功能
│   ├── 智能分析结果展示
│   └── 分析报告生成
└── 实时数据监控
    ├── 关键指标卡片
    ├── 趋势图表展示
    ├── 预警信息汇总
    └── 系统状态监控
```

### 2.2 组件结构
- **HomeEnhanced.vue**：首页主组件
- **子组件**：AI汇总分析组件、指标卡片组件、图表组件等

## 3. 功能详细设计

### 3.1 页面头部区域

#### 3.1.1 系统标题展示
- **组件**：品牌标识区域
- **功能**：显示系统名称"能源监控平台"和副标题"Energy Monitor"
- **交互**：点击Logo可返回首页，响应式适配移动端

#### 3.1.2 场景标签
- **显示内容**：当前选中的演示场景类型
- **标签类型**：通过颜色区分不同场景（大型站/中型站/小型站）
- **图标配合**：每种场景配置相应的FontAwesome图标

#### 3.1.3 功能操作按钮组
```
操作按钮组功能列表
├── 主题切换按钮
│   ├── 功能：深色/浅色模式切换
│   ├── 图标：fa-sun-o / fa-moon-o
│   └── 状态：记忆用户偏好
├── 刷新间隔设置
│   ├── 功能：设置数据自动刷新间隔
│   ├── 选项：10s/30s/60s/5min
│   └── 显示：当前选择的间隔时间
├── 导出功能
│   ├── 功能：导出当前页面数据
│   ├── 格式：Excel/PDF
│   └── 权限：根据用户角色控制
├── 个性化配置
│   ├── 功能：打开个性化设置弹窗
│   ├── 内容：布局自定义、指标配置
│   └── 保存：用户偏好持久化
└── 刷新数据
    ├── 功能：手动触发数据刷新
    ├── 状态：加载中/完成/失败
    └── 反馈：成功/失败消息提示
```

### 3.2 高级筛选区域

#### 3.2.1 筛选条件设计
```
筛选条件配置
├── 车站类型筛选
│   ├── 选项：大型站/中型站/小型站
│   ├── 控件：el-select
│   ├── 默认：全部
│   └── 支持：多选/单选
├── 能耗等级筛选
│   ├── 选项：一级(优秀)/二级(良好)/三级(一般)/四级(较差)
│   ├── 控件：el-select
│   ├── 映射：1/2/3/4
│   └── 显示：等级描述文字
├── 时间范围选择
│   ├── 控件：el-date-picker
│   ├── 类型：datetimerange
│   ├── 格式：YYYY-MM-DD HH:mm:ss
│   └── 预设：今日/本周/本月/本年
└── 操作按钮
    ├── 应用：应用筛选条件
    ├── 重置：清空所有条件
    └── 状态：按钮禁用/启用控制
```

#### 3.2.2 筛选逻辑
- **条件组合**：支持多条件组合筛选
- **实时更新**：筛选条件改变时实时更新显示数据
- **条件记忆**：记住用户上次的筛选设置
- **权限控制**：根据用户角色控制可选筛选项

### 3.3 视图切换器

#### 3.3.1 单站看板视图
- **适用用户**：单站演示角色
- **功能特点**：
  - 单一站点的详细数据展示
  - 深度分析单个车站的能耗状况
  - 提供更多分析维度和历史数据

#### 3.3.2 多站仪表盘视图
- **适用用户**：多站演示、管理员角色
- **功能特点**：
  - 多个站点的对比展示
  - 全局概览和趋势分析
  - 站间对比和排名展示

#### 3.3.3 视图切换逻辑
```
视图切换规则
├── 权限检查
│   ├── 单站角色：仅显示单站看板
│   ├── 多站角色：可切换两种视图
│   └── 管理员：默认多站视图
├── 站点选择
│   ├── 单站视图：显示站点选择下拉框
│   ├── 多站视图：自动加载多个站点
│   └── 默认值：用户上次选择/系统推荐
└── 数据适配
    ├── 单站视图：详细数据展示
    ├── 多站视图：汇总对比数据
    └── 图表适配：根据视图调整图表类型
```

### 3.4 AI汇总分析模块

#### 3.4.1 分析时间范围选择
- **控件类型**：月份选择器
- **功能说明**：
  - 支持选择分析的开始月份和结束月份
  - 格式显示：YYYY年MM月
  - 默认范围：最近12个月
  - 限制条件：开始月份不能晚于结束月份

#### 3.4.2 站点多选功能
- **交互设计**：
  ```
  站点选择交互流程
  ├── 可选站点列表
  │   ├── 来源：用户权限范围内的站点
  │   ├── 显示：站点名称和基本信息
  │   └── 状态：已选/未选标识
  ├── 已选站点展示
  │   ├── 展示方式：标签形式
  │   ├── 操作：支持单个删除
  │   └── 数量限制：根据角色限制最大选择数
  └── 选择控制
      ├── 选择：点击站点名称添加到已选列表
      ├── 取消：点击已选站点标签的关闭按钮
      └── 全选/清空：一键操作支持
  ```

#### 3.4.3 智能分析结果
- **分析维度**：
  ```
  AI分析维度
  ├── 时间趋势分析
  │   ├── 月度能耗变化趋势
  │   ├── 季节性规律识别
  │   ├── 异常波动检测
  │   └── 预测性分析
  ├── 站点对比分析
  │   ├── 站间能耗对比
  │   ├── 效率排名分析
  │   ├── 最佳实践识别
  │   └── 改进建议生成
  ├── 成本效益分析
  │   ├── 能耗成本统计
  │   ├── 节能潜力评估
  │   ├── 投资回报分析
  │   └── 优化方案推荐
  └── 异常检测分析
      ├── 能耗异常识别
      ├── 设备故障预警
      ├── 能耗模式异常
      └── 建议处理措施
  ```

#### 3.4.4 分析结果展示
- **图表类型**：折线图、柱状图、饼图、雷达图
- **数据表格**：详细的分析数据表格
- **文字报告**：AI生成的分析文字报告
- **导出功能**：支持分析结果导出为PDF/Excel

### 3.5 实时数据监控

#### 3.5.1 关键指标卡片
```
指标卡片设计
├── 总能耗指标
│   ├── 当前值：今日/本月总能耗
│   ├── 对比值：同比/环比变化
│   ├── 趋势图标：上升/下降/持平
│   └── 颜色编码：绿色(良好)/红色(异常)
├── 单位面积能耗
│   ├── 计算公式：总能耗/建筑面积
│   ├── 对比基准：行业标准值
│   ├── 等级评定：优秀/良好/一般/较差
│   └── 改进建议：根据等级给出建议
├── 能耗成本
│   ├── 成本计算：能耗 × 单价
│   ├── 成本趋势：历史成本变化
│   ├── 预算对比：与预算的差异
│   └── 节约潜力：成本优化空间
└── 能源效率
    ├── 效率指标：实际效率/理论效率
    ├── 行业对比：与同行业对比
    ├── 效率趋势：效率变化趋势
    └── 提升建议：效率改进措施
```

#### 3.5.2 趋势图表展示
- **图表类型**：ECharts折线图
- **数据更新**：实时数据刷新
- **交互功能**：
  - 缩放：支持鼠标滚轮缩放
  - 拖拽：支持图表拖拽查看
  - 工具提示：鼠标悬停显示详细数据
  - 图例控制：点击图例控制系列显示/隐藏

#### 3.5.3 预警信息汇总
- **预警等级**：高危/中危/低危
- **预警类型**：能耗异常、设备故障、预算超支
- **处理状态**：未处理/处理中/已解决
- **快速操作**：一键跳转处理、批量操作

## 4. 数据设计

### 4.1 数据结构
```javascript
// 首页数据结构
const homeData = {
  // 系统基本信息
  systemInfo: {
    version: 'v1.0.0',
    lastUpdate: '2024-01-04 10:30:00',
    status: 'running',
    totalStations: 15
  },
  
  // 筛选条件
  filters: {
    stationType: '', // 车站类型
    energyLevel: '', // 能耗等级
    timeRange: [], // 时间范围
    stations: [] // 选中站点
  },
  
  // 关键指标
  keyMetrics: {
    totalEnergy: {
      value: 125430,
      unit: 'kWh',
      yoy: 5.2, // 同比
      mom: -2.1 // 环比
    },
    unitAreaEnergy: {
      value: 125.8,
      unit: 'kWh/m²',
      yoy: 3.1,
      mom: -1.8
    },
    energyCost: {
      value: 89450,
      unit: '元',
      yoy: 4.7,
      mom: -3.2
    },
    energyEfficiency: {
      value: 87.5,
      unit: '%',
      yoy: 2.3,
      mom: 1.5
    }
  },
  
  // 图表数据
  charts: {
    energyTrend: [], // 能耗趋势数据
    efficiencyTrend: [], // 效率趋势数据
    costTrend: [] // 成本趋势数据
  },
  
  // AI分析结果
  aiAnalysis: {
    timeRange: {
      start: '2024-01',
      end: '2024-12'
    },
    selectedStations: [],
    analysisResults: {
      trendAnalysis: {},
      comparisonAnalysis: {},
      costBenefitAnalysis: {},
      anomalyDetection: {}
    }
  },
  
  // 预警信息
  alerts: {
    total: 23,
    high: 3,
    medium: 8,
    low: 12,
    recent: [] // 最近预警列表
  }
}
```

### 4.2 数据接口设计
```
数据接口列表
├── 获取首页概览数据
│   ├── 接口：GET /api/home/overview
│   ├── 参数：filters, timeRange, stations
│   ├── 返回：keyMetrics, charts, alerts
│   └── 缓存：5分钟缓存
├── 获取AI分析结果
│   ├── 接口：POST /api/home/ai-analysis
│   ├── 参数：timeRange, stations, analysisType
│   ├── 返回：analysisResults, charts, reports
│   └── 异步：支持异步分析请求
├── 导出首页数据
│   ├── 接口：GET /api/home/export
│   ├── 参数：format, filters, dateRange
│   ├── 返回：文件下载链接
│   └── 格式：Excel, PDF
└── 更新用户偏好
    ├── 接口：PUT /api/user/preferences
    ├── 参数：preferences, theme, layout
    ├── 返回：更新结果
    └── 同步：实时同步到所有页面
```

## 5. 交互设计

### 5.1 用户操作流程
```
首页操作流程图
用户进入首页
    ↓
加载系统状态和基础数据
    ↓
显示默认视图(根据用户角色)
    ↓
用户可选操作：
├── 应用筛选条件
│   └── 更新显示数据
├── 切换视图模式
│   └── 适配不同数据展示
├── 配置AI分析
│   └── 生成智能分析报告
├── 个性化设置
│   └── 调整显示偏好
└── 导出数据
    └── 生成导出文件
```

### 5.2 响应式适配
```
响应式设计规则
├── 桌面端 (≥1280px)
│   ├── 完整功能展示
│   ├── 多列布局
│   ├── 完整图表显示
│   └── 悬浮效果
├── 平板端 (768px-1279px)
│   ├── 简化功能菜单
│   ├── 双列布局
│   ├── 适配图表尺寸
│   └── 触摸优化
└── 移动端 (<768px)
    ├── 底部导航栏
    ├── 单列布局
    ├── 卡片式展示
    └── 滑动交互
```

### 5.3 加载状态设计
```
加载状态管理
├── 初始加载
│   ├── 骨架屏展示
│   ├── 进度条指示
│   ├── 逐步加载组件
│   └── 错误重试机制
├── 数据刷新
│   ├── 局部加载动画
│   ├── 数据保持显示
│   ├── 刷新状态提示
│   └── 失败回滚数据
├── AI分析
│   ├── 分析进度显示
│   ├── 预估完成时间
│   ├── 可取消操作
│   └── 结果缓存机制
└── 导出操作
    ├── 导出进度条
    ├── 后台处理提示
    ├── 完成通知
    └── 文件下载状态
```

## 6. 性能设计

### 6.1 性能指标
- **首屏加载时间**：≤ 3秒
- **数据刷新延迟**：≤ 1秒
- **图表渲染时间**：≤ 2秒
- **AI分析响应时间**：≤ 10秒
- **页面切换时间**：≤ 0.5秒

### 6.2 优化策略
```
性能优化方案
├── 数据加载优化
│   ├── 分页加载大数据集
│   ├── 懒加载非关键组件
│   ├── 数据缓存机制
│   └── CDN加速静态资源
├── 图表性能优化
│   ├── 虚拟滚动长列表
│   ├── 图表数据采样
│   ├── Canvas渲染优化
│   └── 图表复用机制
├── 内存管理
│   ├── 及时清理定时器
│   ├── 组件销毁时清理事件
│   ├── 大对象复用
│   └── 内存泄漏检测
└── 网络优化
    ├── 请求合并
    ├── 数据压缩
    ├── 缓存策略
    └── 离线支持
```

## 7. 安全设计

### 7.1 权限控制
```
权限控制规则
├── 角色权限
│   ├── 单站演示：仅查看授权站点
│   ├── 多站演示：查看部分多站数据
│   └── 管理员：全功能访问权限
├── 数据权限
│   ├── 站点级权限控制
│   ├── 功能模块权限控制
│   ├── 操作权限控制
│   └── 数据导出权限控制
└── 界面权限
    ├── 菜单项显示控制
    ├── 按钮显示控制
    ├── 数据字段显示控制
    └── 页面访问控制
```

### 7.2 数据安全
- **敏感数据脱敏**：用户信息、设备编号等
- **数据传输加密**：HTTPS协议
- **数据存储加密**：LocalStorage敏感数据加密
- **操作日志记录**：关键操作审计日志

## 8. 错误处理

### 8.1 异常场景
```
异常处理机制
├── 网络异常
│   ├── 连接超时
│   ├── 服务器错误
│   ├── 网络中断
│   └── 处理：重试机制、离线提示
├── 数据异常
│   ├── 数据格式错误
│   ├── 缺失必要字段
│   ├── 数据权限不足
│   └── 处理：友好提示、数据回退
├── 权限异常
│   ├── 登录状态失效
│   ├── 权限不足
│   ├── 访问受限资源
│   └── 处理：重新登录、权限提示
└── 系统异常
    ├── JavaScript错误
    ├── 组件渲染错误
    ├── 第三方库异常
    └── 处理：错误边界、错误上报
```

### 8.2 用户体验
- **友好错误提示**：清晰的错误信息和解决建议
- **错误恢复机制**：自动重试和手动恢复选项
- **降级策略**：功能不可用时的替代方案
- **错误上报**：技术问题自动上报机制

## 9. 测试设计

### 9.1 测试用例
```
测试用例覆盖
├── 功能测试
│   ├── 页面加载测试
│   ├── 筛选功能测试
│   ├── 视图切换测试
│   ├── AI分析功能测试
│   ├── 数据导出测试
│   └── 个性化设置测试
├── 性能测试
│   ├── 页面加载速度测试
│   ├── 数据刷新性能测试
│   ├── 大量数据渲染测试
│   ├── 并发用户测试
│   └── 内存泄漏测试
├── 兼容性测试
│   ├── 浏览器兼容性测试
│   ├── 响应式设计测试
│   ├── 不同分辨率测试
│   └── 移动端适配测试
└── 安全测试
    ├── 权限控制测试
    ├── XSS攻击测试
    ├── CSRF攻击测试
    └── 数据安全测试
```

### 9.2 自动化测试
- **单元测试**：组件功能测试
- **集成测试**：页面功能流程测试
- **端到端测试**：用户操作场景测试
- **性能测试**：页面性能指标测试

## 10. 部署和维护

### 10.1 部署要求
- **环境要求**：Node.js 16+, npm 8+
- **浏览器支持**：Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
- **移动端支持**：iOS 14+, Android 10+
- **分辨率支持**：1920x1080, 1366x768, 1280x720等主流分辨率

### 10.2 维护策略
```
维护计划
├── 日常维护
│   ├── 性能监控
│   ├── 错误日志分析
│   ├── 用户反馈处理
│   └── 数据备份检查
├── 定期维护
│   ├── 依赖库更新
│   ├── 安全补丁应用
│   ├── 性能优化调整
│   └── 功能迭代更新
└── 故障处理
    ├── 快速响应机制
    ├── 问题诊断流程
    ├── 应急恢复方案
    └── 用户沟通机制
```

## 11. 未来扩展

### 11.1 功能扩展
- **多语言支持**：国际化功能
- **高级分析**：更复杂的AI分析算法
- **移动应用**：原生移动端应用
- **API开放**：提供开放API接口

### 11.2 技术扩展
- **微服务架构**：系统架构升级
- **大数据处理**：大数据分析能力
- **实时通信**：WebSocket实时数据推送
- **人工智能**：更智能的预测和建议

---

**文档版本**：v1.0  
**创建时间**：2024-01-04  
**最后更新**：2024-01-04  
**负责人**：产品技术团队