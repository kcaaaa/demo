# 能耗占比分析功能设计文档

UI设计地址：https://www.figma.com/design/k5TBKzoZJ0DPn5LobyEc20/%E9%AB%98%E9%93%81%E7%AB%99%E8%83%BD%E8%80%97%E6%BC%94%E7%A4%BA?node-id=22-2075&m=dev

## 1. 功能概述

能耗占比分析模块是高铁站节能降耗演示系统的核心功能之一，通过多维度的能耗占比分析，帮助用户深入了解车站能耗的分布情况和变化趋势。该模块通过丰富的图表展示和交互式分析，使用户能够直观地了解不同维度下的能耗占比，为节能优化提供数据支持。

### 1.1 功能定位

- **数据分析中心**：提供多维度能耗占比数据分析
- **可视化展示平台**：通过多种图表形式展示能耗占比
- **趋势分析工具**：分析能耗占比的变化趋势
- **对比分析平台**：支持不同维度间的对比分析

### 1.2 用户群体

- **能源管理专员**：负责车站能耗监控和分析
- **运营管理人员**：关注运营成本和效率
- **维护人员**：需要了解设备能耗占比情况
- **高层管理者**：需要宏观数据支持决策

### 1.3 核心价值

- **多维度分析**：支持按区域、设备类型、时段、能耗类型等维度分析
- **直观可视化**：通过饼图、面积图等直观展示占比
- **趋势分析**：提供能耗占比的趋势变化分析
- **交互式操作**：支持维度切换、数据刷新等交互操作

## 2. 功能架构

能耗占比分析模块的功能架构如下：

```
能耗占比分析
├── 页面头部模块
│   ├── 标题展示
│   ├── 功能描述
│   └── 操作按钮组
├── 搜索筛选模块
│   ├── 关键词搜索
│   ├── 日期范围选择
│   ├── 能耗类型选择
│   └── 数据刷新按钮
├── 能耗比例概览模块
│   ├── 总能耗占比指标
│   ├── 电力占比指标
│   ├── 空调占比指标
│   └── 照明占比指标
├── 能耗比例图表模块
│   ├── 按区域能耗比例图
│   ├── 按设备类型能耗比例图
│   ├── 按时段能耗比例图
│   └── 按能耗类型比例图
├── 能耗趋势分析模块
│   ├── 能耗比例趋势图
│   └── 趋势数据交互
└── 详细数据分析模块
    ├── 数据表格展示
    ├── 维度切换功能
    └── 数据导出功能
```

## 3. 详细功能设计

### 3.1 页面头部模块

页面头部模块展示模块标题、功能描述和操作按钮：

#### 3.1.1 设计规范

- 页面头部使用白色背景，带有轻微阴影效果
- 标题使用28px字体大小，子标题使用16px字体大小
- 操作按钮组包括"选择对比维度"和"导出报表"按钮
- 操作按钮悬停时带有轻微上浮效果

### 3.2 搜索筛选模块

搜索筛选模块提供数据查询和筛选功能：

#### 3.2.1 搜索功能

- **关键词搜索**：支持搜索数据、设备或区域
- 搜索框采用圆角设计，内置搜索图标
- 支持清除搜索内容

#### 3.2.2 筛选功能

- **日期范围选择**：支持自定义日期范围
- **能耗类型选择**：支持选择总能耗、电力、空调、照明等类型
- **数据刷新按钮**：支持手动刷新数据，带有徽章显示待更新项数量

#### 3.2.3 设计规范

- 使用Element Plus的表单组件构建
- 采用响应式布局，在不同屏幕尺寸下自适应调整
- 筛选按钮组采用网格布局，在移动端自动调整为垂直排列

### 3.3 能耗比例概览模块

能耗比例概览模块以卡片形式展示主要能耗比例指标：

#### 3.3.1 指标卡片

- **总能耗占比**：显示总能耗占比百分比
- **电力占比**：显示电力能耗占比百分比
- **空调占比**：显示空调能耗占比百分比
- **照明占比**：显示照明能耗占比百分比

#### 3.3.2 设计规范

- 采用响应式网格布局，4个指标卡片分别在中等及以上屏幕中占6列，在小屏幕中占12列
- 卡片使用白色背景，圆角设计，轻微阴影
- 每个卡片左侧有彩色图标，使用主题色#409EFF
- 卡片内容使用渐入动画效果

### 3.4 能耗比例图表模块

能耗比例图表模块使用多个饼图展示不同维度下的能耗占比：

#### 3.4.1 按区域能耗比例图

- 使用ECharts绘制饼图
- 展示候车大厅、售票区域、站台区域、办公区域等的能耗占比
- 支持环形饼图，内圈显示总能耗，外圈显示各区域占比
- 支持图例显示和交互悬停

#### 3.4.2 按设备类型能耗比例图

- 使用ECharts绘制标准饼图
- 展示照明设备、空调系统、电梯系统等的能耗占比
- 支持交互悬停显示详细数据

#### 3.4.3 按时段能耗比例图

- 使用ECharts绘制标准饼图
- 展示凌晨、早晨、上午、下午、晚上等时段的能耗占比
- 支持交互悬停显示详细数据

#### 3.4.4 按能耗类型比例图

- 使用ECharts绘制标准饼图
- 展示电力、燃气、蒸汽、其他等能耗类型的占比
- 支持交互悬停显示详细数据

#### 3.4.5 设计规范

- 在中等及以上屏幕中，4个图表各占6列；在小屏幕中各占12列
- 图表容器使用白色背景和轻微阴影
- 图表标题使用页面主题色#409EFF
- 图表使用渐入动画效果

### 3.5 能耗趋势分析模块

能耗趋势分析模块展示能耗比例的趋势变化：

#### 3.5.1 能耗比例趋势图

- 使用ECharts绘制堆叠面积图
- 展示电力、空调、照明、其他等能耗类型随时间变化的趋势
- 使用不同颜色区分不同能耗类型
- 支持图例交互和悬停显示详细数据

#### 3.5.2 设计规范

- 图表容器使用白色背景和轻微阴影
- 图表标题使用页面主题色#409EFF
- 图表使用渐入动画效果
- 图表区域使用网格布局，便于数据对齐

### 3.6 详细数据分析模块

详细数据分析模块提供表格形式的数据详情：

#### 3.6.1 数据表格

- 表格展示名称、能耗值、占比、成本、同比变化、环比变化等信息
- 占比列使用进度条形式展示，直观显示占比大小
- 同比和环比变化使用颜色区分，正值用红色，负值用绿色
- 支持分页功能，便于浏览大量数据

#### 3.6.2 维度切换

- 支持切换分析维度（区域、设备类型、时段等）
- 根据选择的维度动态更新表格数据

#### 3.6.3 设计规范

- 表格使用Element Plus的表格组件
- 表头使用浅灰色背景
- 表格行使用斑马纹样式，提高可读性
- 表格使用渐入动画效果

## 4. 数据结构设计

### 4.1 能耗比例概览数据结构

```javascript
{
  totalEnergyRatio: 100,        // 总能耗占比
  electricityRatio: 45,         // 电力占比
  acRatio: 30,                  // 空调占比
  lightingRatio: 15             // 照明占比
}
```

### 4.2 按区域能耗比例数据结构

```javascript
{
  areaChartData: [
    { value: 12500, name: '候车大厅' },
    { value: 4500, name: '售票区域' },
    { value: 8200, name: '站台区域' },
    { value: 6800, name: '办公区域' },
    { value: 3400, name: '其他区域' }
  ]
}
```

### 4.3 按设备类型能耗比例数据结构

```javascript
{
  deviceTypeChartData: [
    { value: 1048, name: '照明设备' },
    { value: 735, name: '空调系统' },
    { value: 580, name: '电梯系统' },
    { value: 484, name: '显示屏' },
    { value: 300, name: '其他设备' }
  ]
}
```

### 4.4 按时段能耗比例数据结构

```javascript
{
  timeChartData: [
    { value: 335, name: '凌晨' },
    { value: 310, name: '早晨' },
    { value: 274, name: '上午' },
    { value: 235, name: '下午' },
    { value: 400, name: '晚上' }
  ]
}
```

### 4.5 按能耗类型比例数据结构

```javascript
{
  energyTypeChartData: [
    { value: 1350, name: '电力' },
    { value: 800, name: '燃气' },
    { value: 450, name: '蒸汽' },
    { value: 200, name: '其他' }
  ]
}
```

### 4.6 能耗趋势数据结构

```javascript
{
  trendChartData: {
    xAxis: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],
    series: [
      { name: '电力', data: [320, 332, 301, 334, 390, 330, 320, 350, 340, 360, 370, 380] },
      { name: '空调', data: [220, 182, 191, 234, 290, 330, 310, 280, 260, 240, 250, 270] },
      { name: '照明', data: [150, 232, 201, 154, 190, 230, 210, 190, 170, 160, 180, 200] },
      { name: '其他', data: [50, 42, 31, 54, 70, 63, 50, 40, 30, 35, 40, 45] }
    ]
  }
}
```

### 4.7 详细数据结构

```javascript
{
  detailedData: [
    { 
      name: '候车大厅', 
      energyConsumption: 12500, 
      percentage: 35, 
      cost: 8750, 
      yearOnYear: -5.2, 
      monthOnMonth: 2.1 
    },
    // 更多详细数据...
  ]
}
```

## 5. 交互流程设计

### 5.1 数据查询流程

```
用户进入能耗占比分析页面
    ↓
系统默认加载当前站点数据
    ↓
用户设置筛选条件（日期范围、能耗类型等）
    ↓
用户点击刷新按钮或执行搜索
    ↓
系统根据筛选条件请求数据
    ↓
系统更新能耗比例概览和图表
    ↓
用户查看分析结果
```

### 5.2 图表交互流程

```
用户进入能耗占比分析页面
    ↓
图表组件加载并初始化
    ↓
用户悬停或点击图表元素
    ↓
系统展示数据详情提示
    ↓
用户切换分析维度
    ↓
系统更新图表数据和展示内容
```

### 5.3 详细数据分析流程

```
用户查看详细数据分析模块
    ↓
系统展示默认维度（区域）的详细数据
    ↓
用户切换分析维度（设备类型、时段等）
    ↓
系统根据选择的维度更新表格数据
    ↓
用户浏览表格数据，了解详细占比信息
```

## 6. 异常处理机制

### 6.1 数据加载异常

- **场景**：数据请求失败或超时
- **处理**：显示错误提示信息，提供重试按钮
- **用户反馈**：明确告知错误原因和解决建议

### 6.2 数据格式异常

- **场景**：服务器返回的数据格式不符合预期
- **处理**：尝试解析数据，如无法解析则使用默认数据
- **用户反馈**：在控制台输出错误信息，并在界面上显示友好提示

### 6.3 图表渲染异常

- **场景**：图表库加载失败或渲染出错
- **处理**：显示图表加载失败的提示信息
- **用户反馈**：提供图表加载失败的原因和解决建议

## 7. 性能优化方案

### 7.1 数据缓存

- 缓存已查询的数据，避免重复请求
- 根据筛选条件生成唯一缓存键
- 设置缓存过期时间，确保数据的时效性

### 7.2 图表优化

- 使用ECharts的按需加载功能，只加载必要的图表组件
- 对于大数据量的图表，使用数据聚合减少数据点数量
- 实现图表的延迟渲染，提升页面初始加载速度

### 7.3 懒加载

- 对非首屏图表使用懒加载功能
- 当图表进入视口时再进行渲染，减少初始渲染压力

## 8. 安全考虑

### 8.1 数据安全

- 对敏感数据进行脱敏处理
- 实现基于角色的数据访问控制
- 记录关键操作的审计日志

### 8.2 接口安全

- 对所有数据请求进行身份验证
- 使用HTTPS协议传输数据
- 对输入参数进行验证和过滤

## 9. 响应式设计

### 9.1 布局适配

- 在大屏幕（≥1200px）中显示完整的布局和内容
- 在中等屏幕（768px-1199px）中适当调整卡片大小和间距
- 在小屏幕（<768px）中转换为垂直布局，调整元素排列

### 9.2 图表适配

- 图表容器在小屏幕中自动调整高度
- 图表中的文字和图例在小屏幕中适当缩小
- 复杂图表在小屏幕中提供简化的视图模式

## 10. 后续迭代计划

### 10.1 功能增强

- 添加更多维度的占比分析（如按楼层、按设备等）
- 增加同比、环比数据对比功能
- 添加自定义时间段分析功能

### 10.2 用户体验优化

- 添加图表的更多交互功能（如缩放、平移等）
- 实现自定义仪表板功能，允许用户个性化配置
- 添加数据钻取功能，支持从概览到详情的层级查看

### 10.3 性能优化

- 实现更智能的数据缓存策略
- 添加数据预加载功能，提升用户体验
- 优化大数据量场景下的图表渲染性能

## 11. 附录

### 11.1 依赖库和框架

- Vue.js 3.0+
- Element Plus 2.0+
- ECharts 5.0+
- FontAwesome 5.0+
- Sass/SCSS 1.0+

### 11.2 相关文档

- 系统总体需求文档
- 系统架构设计文档
- 数据库设计文档
- 接口设计文档

---

*文档版本：1.0*  
*创建日期：2026-01-04*  
*最后更新：2026-01-04*  
*创建者：系统架构师*  
*审核者：产品经理*