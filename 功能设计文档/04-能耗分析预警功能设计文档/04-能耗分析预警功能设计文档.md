# 能耗分析预警功能设计文档

UI设计地址：https://www.figma.com/design/k5TBKzoZJ0DPn5LobyEc20/%E9%AB%98%E9%93%81%E7%AB%99%E8%83%BD%E8%80%97%E6%BC%94%E7%A4%BA?node-id=22-3647&m=dev

## 1. 功能概述

能耗分析预警模块是高铁站节能降耗演示系统的核心功能之一，通过实时监控车站能耗数据，智能检测异常并发出预警信号，帮助用户及时发现能耗异常情况，采取相应的处理措施。该模块通过可视化图表展示预警分布和趋势，支持预警筛选和处理，提供全方位的能耗异常监控和管理能力。

### 1.1 功能定位

- **能耗监控中心**：实时监控车站能耗数据变化
- **预警管理平台**：提供能耗异常的检测、预警和管理功能
- **数据分析工具**：分析预警分布和趋势变化
- **处理工作台**：支持预警的查看、处理和追踪

### 1.2 用户群体

- **能源管理专员**：负责监控能耗数据，接收和处理预警
- **运维工程师**：需要了解设备异常和故障情况
- **站点管理员**：需要监控站点能耗状态
- **高层管理者**：需要了解整体预警状况

### 1.3 核心价值

- **实时监控**：提供7×24小时能耗数据监控
- **智能预警**：自动检测能耗异常并发出预警
- **分级预警**：根据严重程度分级预警（高危、中危、低危）
- **多维分析**：支持预警的分布分析和趋势分析
- **处理追踪**：支持预警处理状态的跟踪和管理

## 2. 功能架构

能耗分析预警模块的功能架构如下：

```
能耗分析预警
├── 页面标题模块
│   ├── 模块标题展示
│   └── 功能描述
├── 预警概览模块
│   ├── 总预警数指标
│   ├── 高危预警数指标
│   ├── 中危预警数指标
│   ├── 低危预警数指标
│   └── 今日新增预警数指标
├── 预警分布模块
│   ├── 预警等级分布饼图
│   └── 预警类型分布柱状图
├── 预警监控模块
│   ├── 预警趋势监控线图
│   └── 时间范围切换功能
├── 预警列表模块
│   ├── 预警记录表格
│   ├── 状态筛选功能
│   ├── 等级筛选功能
│   ├── 预警详情查看
│   ├── 预警处理功能
│   └── 分页功能
└── 预警处理工作流
    ├── 预警通知
    ├── 预警处理
    ├── 预警解决
    └── 预警记录
```

## 3. 详细功能设计

### 3.1 页面标题模块

页面标题模块展示模块标题和功能描述：

#### 3.1.1 设计规范

- 页面标题使用白色背景，带有轻微阴影效果
- 标题使用28px字体大小，副标题使用16px字体大小
- 标题左侧添加预警图标（fa fa-exclamation-triangle）
- 整体风格与系统主题色#409EFF保持一致

### 3.2 预警概览模块

预警概览模块以卡片形式展示主要预警指标：

#### 3.2.1 指标卡片设计

- **总预警数**：显示当前系统中所有预警的数量
- **高危预警数**：显示高危预警的数量（带红色警告图标）
- **中危预警数**：显示中危预警的数量（带橙色警告图标）
- **低危预警数**：显示低危预警的数量（带绿色信息图标）

#### 3.2.2 设计规范

- 采用响应式网格布局，4个指标卡片分别在中等及以上屏幕中占6列，在小屏幕中占12列
- 卡片使用白色背景，圆角设计，轻微阴影
- 每个卡片左侧有彩色图标，高危使用红色（#F56C6C），中危使用橙色（#E6A23C），低危使用绿色（#67C23A）
- 指标卡片使用渐入动画效果
- 卡片内容使用渐入动画效果

### 3.3 预警分布模块

预警分布模块通过图表展示预警的分布情况：

#### 3.3.1 预警等级分布饼图

- 使用ECharts绘制环形饼图
- 展示高危、中危、低危预警的分布比例
- 使用不同颜色区分不同等级：高危使用红色（#F56C6C），中危使用橙色（#E6A23C），低危使用绿色（#67C23A）
- 支持图例显示和交互悬停
- 支持图例点击隐藏/显示特定等级数据

#### 3.3.2 预警类型分布柱状图

- 使用ECharts绘制横向柱状图
- 展示能耗突增、能耗突降、异常持续、超阈值、设备故障、其他等类型的预警数量
- 使用渐变色填充柱子，从蓝色（#409EFF）到绿色（#67C23A）
- 支持悬停显示详细信息
- 柱子上显示具体数值

#### 3.3.3 设计规范

- 在中等及以上屏幕中，2个图表各占12列；在小屏幕中各占12列
- 图表容器使用白色背景和轻微阴影
- 图表标题使用页面主题色#409EFF
- 图表使用渐入动画效果

### 3.4 预警监控模块

预警监控模块展示预警的趋势变化：

#### 3.4.1 预警趋势监控线图

- 使用ECharts绘制堆叠面积图
- 展示高危、中危、低危预警随时间变化的趋势
- 使用不同颜色区分不同等级：高危使用红色，中危使用橙色，低危使用绿色
- 支持图例交互和悬停显示详细数据
- 支持时间范围切换（今日、近7天、近30天）
- 使用平滑曲线展示趋势变化

#### 3.4.2 设计规范

- 图表容器使用白色背景和轻微阴影
- 图表标题使用页面主题色#409EFF
- 图表使用渐入动画效果
- 图表区域使用网格布局，便于数据对齐

### 3.5 预警列表模块

预警列表模块提供预警记录的详细展示和处理功能：

#### 3.5.1 预警记录表格

- 表格展示预警时间、站点、预警类型、预警等级、预警内容、状态、处理人等信息
- 预警类型、预警等级和状态使用标签（el-tag）展示，并使用不同颜色区分
- 序号列使用序号显示
- 支持斑马纹样式，提高可读性
- 支持分页功能，便于浏览大量数据

#### 3.5.2 筛选功能

- **状态筛选**：支持按状态筛选（全部、未处理、处理中、已解决、已忽略）
- **等级筛选**：支持按等级筛选（全部、高危、中危、低危）
- **刷新按钮**：支持手动刷新预警数据

#### 3.5.3 操作功能

- **查看详情**：点击查看按钮可查看预警的详细信息
- **处理预警**：未处理状态的预警可标记为处理中，已处理状态的预警可查看详情
- **处理人**：显示当前处理预警的人员姓名

#### 3.5.4 设计规范

- 表格使用Element Plus的表格组件
- 表头使用浅灰色背景
- 操作按钮使用Element Plus的按钮组件，支持图标
- 表格使用渐入动画效果

### 3.6 预警处理工作流

预警处理工作流支持预警的完整生命周期管理：

#### 3.6.1 预警通知

- 系统自动检测到异常时生成预警
- 预警包含时间、站点、类型、等级、内容等信息
- 预警状态默认为"未处理"

#### 3.6.2 预警处理

- 用户查看预警详情
- 用户可将"未处理"状态的预警标记为"处理中"
- 处理预警时需指定处理人
- 系统记录处理人信息

#### 3.6.3 预警解决

- 处理完成后，用户可将预警状态更新为"已解决"
- 已解决的预警保留完整记录
- 预警解决后可选择是否添加解决备注

#### 3.6.4 预警记录

- 系统保留所有预警的历史记录
- 支持按各种条件筛选和查询预警
- 支持预警状态的变更历史记录

## 4. 数据结构设计

### 4.1 预警概览数据结构

```javascript
{
  totalAlerts: 128,           // 总预警数
  newAlertsToday: 15,         // 今日新增预警数
  highLevelAlerts: 23,        // 高危预警数
  mediumLevelAlerts: 45,      // 中危预警数
  lowLevelAlerts: 60,         // 低危预警数
  processingHighAlerts: 8,    // 处理中高危预警数
  processingMediumAlerts: 15, // 处理中中危预警数
  processingLowAlerts: 20     // 处理中低危预警数
}
```

### 4.2 预警等级分布数据结构

```javascript
{
  alertLevelChartData: [
    { value: 23, name: '高危', itemStyle: { color: '#F56C6C' } },
    { value: 45, name: '中危', itemStyle: { color: '#E6A23C' } },
    { value: 60, name: '低危', itemStyle: { color: '#67C23A' } }
  ]
}
```

### 4.3 预警类型分布数据结构

```javascript
{
  alertTypeChartData: [
    { name: '能耗突增', value: 35 },
    { name: '能耗突降', value: 28 },
    { name: '异常持续', value: 22 },
    { name: '超阈值', value: 18 },
    { name: '设备故障', value: 15 },
    { name: '其他', value: 10 }
  ]
}
```

### 4.4 预警趋势数据结构

```javascript
{
  alertTrendChartData: {
    xAxis: ['1日', '2日', '3日', '4日', '5日', '6日', '7日'],
    series: [
      { name: '高危预警', data: [5, 3, 4, 6, 2, 5, 3] },
      { name: '中危预警', data: [8, 10, 7, 9, 11, 8, 12] },
      { name: '低危预警', data: [12, 15, 10, 13, 16, 14, 18] }
    ]
  }
}
```

### 4.5 预警列表数据结构

```javascript
{
  alerts: [
    {
      id: 1,
      time: '2024-01-15 14:30:00',
      station: '北京南站',
      type: '能耗突增',
      level: 'high',
      content: '候车大厅空调系统能耗突增30%',
      status: 'unprocessed',
      handler: '',
      details: '2024-01-15 14:25:00开始，候车大厅空调系统能耗从正常的1200kWh/h突增至1560kWh/h，增幅达30%'
    },
    // 更多预警记录...
  ]
}
```

### 4.6 预警类型映射数据结构

```javascript
{
  alertTypeMapping: {
    '能耗突增': 'danger',
    '能耗突降': 'warning',
    '异常持续': 'info',
    '超阈值': 'success',
    '设备故障': 'danger',
    '其他': 'info'
  }
}
```

### 4.7 预警等级映射数据结构

```javascript
{
  alertLevelMapping: {
    'high': 'danger',
    'medium': 'warning',
    'low': 'success'
  }
}
```

### 4.8 预警状态映射数据结构

```javascript
{
  alertStatusMapping: {
    'unprocessed': 'danger',
    'processing': 'warning',
    'resolved': 'success',
    'ignored': 'info'
  }
}
```

## 5. 交互流程设计

### 5.1 预警生成流程

```
能耗数据采集
    ↓
数据预处理和清洗
    ↓
异常检测算法运行
    ↓
检测到异常
    ↓
生成预警记录
    ↓
保存预警到数据库
    ↓
发送预警通知
    ↓
用户查看预警
```

### 5.2 预警处理流程

```
用户查看预警列表
    ↓
选择要处理的预警
    ↓
点击处理按钮
    ↓
确认处理操作
    ↓
更新预警状态为"处理中"
    ↓
记录处理人信息
    ↓
处理完成后更新状态为"已解决"
    ↓
记录解决信息
    ↓
完成预警处理流程
```

### 5.3 图表交互流程

```
用户进入预警分析页面
    ↓
图表组件加载并初始化
    ↓
用户悬停或点击图表元素
    ↓
系统展示数据详情提示
    ↓
用户切换时间范围
    ↓
系统更新图表数据和展示内容
```

## 6. 异常处理机制

### 6.1 数据加载异常

- **场景**：数据请求失败或超时
- **处理**：显示错误提示信息，提供重试按钮
- **用户反馈**：明确告知错误原因和解决建议

### 6.2 数据格式异常

- **场景**：服务器返回的数据格式不符合预期
- **处理**：尝试解析数据，如无法解析则使用默认数据
- **用户反馈**：在控制台输出错误信息，并在界面上显示友好提示

### 6.3 图表渲染异常

- **场景**：图表库加载失败或渲染出错
- **处理**：显示图表加载失败的提示信息
- **用户反馈**：提供图表加载失败的原因和解决建议

### 6.4 预警处理异常

- **场景**：预警处理请求失败
- **处理**：显示错误提示，保持预警状态不变
- **用户反馈**：提示用户稍后重试或联系管理员

## 7. 性能优化方案

### 7.1 数据缓存

- 缓存已查询的预警数据，避免重复请求
- 根据筛选条件生成唯一缓存键
- 设置缓存过期时间，确保数据的时效性

### 7.2 图表优化

- 使用ECharts的按需加载功能，只加载必要的图表组件
- 对于大数据量的图表，使用数据聚合减少数据点数量
- 实现图表的延迟渲染，提升页面初始加载速度
- 实现图表的懒加载，当图表进入视口时再进行渲染

### 7.3 分页优化

- 使用后端分页，减少单次加载的数据量
- 使用虚拟滚动技术，提升大数据量表格的渲染性能

### 7.4 数据更新策略

- 使用WebSocket实现预警数据的实时推送
- 对于非实时数据，使用定时轮询策略
- 实现增量更新，只更新变化的数据部分

## 8. 安全考虑

### 8.1 数据安全

- 对敏感预警数据进行脱敏处理
- 实现基于角色的数据访问控制
- 记录关键操作的审计日志

### 8.2 接口安全

- 对所有数据请求进行身份验证
- 使用HTTPS协议传输数据
- 对输入参数进行验证和过滤

### 8.3 权限控制

- 不同角色用户只能访问权限范围内的预警数据
- 预警处理权限需要特定角色授权
- 预警状态变更需要记录操作人信息

## 9. 响应式设计

### 9.1 布局适配

- 在大屏幕（≥1200px）中显示完整的布局和内容
- 在中等屏幕（768px-1199px）中适当调整卡片大小和间距
- 在小屏幕（<768px）中转换为垂直布局，调整元素排列

### 9.2 图表适配

- 图表容器在小屏幕中自动调整高度
- 图表中的文字和图例在小屏幕中适当缩小
- 复杂图表在小屏幕中提供简化的视图模式

## 10. 后续迭代计划

### 10.1 功能增强

- 添加更多预警类型（如能耗波动、设备离线等）
- 增加预警规则配置功能，允许用户自定义预警阈值
- 添加预警通知设置，支持邮件、短信、APP推送等多种通知方式

### 10.2 用户体验优化

- 添加预警的更多交互功能（如预警标记、预警备注等）
- 实现预警处理的批量操作功能
- 添加预警处理的自动化建议功能

### 10.3 性能优化

- 实现更智能的数据缓存策略
- 添加数据预加载功能，提升用户体验
- 优化大数据量场景下的图表渲染性能
- 实现预警数据的增量更新机制

## 11. 附录

### 11.1 依赖库和框架

- Vue.js 3.0+
- Element Plus 2.0+
- ECharts 5.0+
- FontAwesome 5.0+
- Sass/SCSS 1.0+

### 11.2 相关文档

- 系统总体需求文档
- 系统架构设计文档
- 数据库设计文档
- 接口设计文档

---

*文档版本：1.0*  
*创建日期：2026-01-04*  
*最后更新：2026-01-04*  
*创建者：系统架构师*  
*审核者：产品经理*