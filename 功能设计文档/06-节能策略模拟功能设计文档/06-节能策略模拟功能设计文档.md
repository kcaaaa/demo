# 节能策略模拟功能设计文档

UI设计地址：
策略推荐模块：https://www.figma.com/design/k5TBKzoZJ0DPn5LobyEc20/%E9%AB%98%E9%93%81%E7%AB%99%E8%83%BD%E8%80%97%E6%BC%94%E7%A4%BA?node-id=23-4924&m=dev
策略组合模块：https://www.figma.com/design/k5TBKzoZJ0DPn5LobyEc20/%E9%AB%98%E9%93%81%E7%AB%99%E8%83%BD%E8%80%97%E6%BC%94%E7%A4%BA?node-id=24-6080&m=dev
快速模拟模块：https://www.figma.com/design/k5TBKzoZJ0DPn5LobyEc20/%E9%AB%98%E9%93%81%E7%AB%99%E8%83%BD%E8%80%97%E6%BC%94%E7%A4%BA?node-id=24-7449&m=dev
历史记录模块：https://www.figma.com/design/k5TBKzoZJ0DPn5LobyEc20/%E9%AB%98%E9%93%81%E7%AB%99%E8%83%BD%E8%80%97%E6%BC%94%E7%A4%BA?node-id=24-7106&m=dev
模板管理模块：https://www.figma.com/design/k5TBKzoZJ0DPn5LobyEc20/%E9%AB%98%E9%93%81%E7%AB%99%E8%83%BD%E8%80%97%E6%BC%94%E7%A4%BA?node-id=23-5342&m=dev
实时模拟模块：https://www.figma.com/design/k5TBKzoZJ0DPn5LobyEc20/%E9%AB%98%E9%93%81%E7%AB%99%E8%83%BD%E8%80%97%E6%BC%94%E7%A4%BA?node-id=24-6506&m=dev


## 一、功能概述

### 1.1 功能定义
节能策略模拟功能是高铁站节能降耗演示系统中的核心功能模块，通过智能推荐、模板管理、策略组合、实时模拟等手段，帮助用户设计、优化和评估各种节能策略，实现站房能源使用的优化配置和节能效果的最大化。

### 1.2 核心价值
- 提供多维度智能节能策略推荐，降低能源消耗
- 通过可视化模拟展示策略实施效果，提供决策依据
- 整合历史数据和实时监测数据，动态优化策略参数
- 支持策略组合和对比分析，实现多策略协同优化
- 评估投资回报和节能效果，指导节能投资决策

### 1.3 应用场景
- 节能改造方案设计与评估
- 能源管理策略优化
- 节能改造投资决策支持
- 节能效果预测与验证
- 运营期节能策略调整

## 二、系统架构

### 2.1 整体架构
```
节能策略模拟系统
├── 主界面模块
│   ├── 系统状态监控
│   └── 标签页导航
├── 策略推荐模块
│   ├── 条件设置
│   ├── 推荐算法
│   └── 结果展示
├── 模板管理模块
│   ├── 模板分类
│   ├── 模板搜索
│   └── 模板操作
├── 策略组合模块
│   ├── 多策略组合
│   ├── 组合效果分析
│   └── 参数调整
├── 实时模拟模块
│   ├── 模拟引擎
│   ├── 实时数据
│   └── 模拟结果
└── 历史记录模块
    ├── 记录查询
    ├── 记录分析
    └── 记录导出
```

### 2.2 技术架构
- 前端框架：Vue 3
- UI组件库：Element UI
- 图表组件：ECharts
- 状态管理：Vuex
- 数据存储：LocalStorage/SessionStorage

### 2.3 数据流架构
```
用户输入 → 条件筛选 → 推荐算法 → 结果生成 → 策略选择 → 模拟执行 → 效果评估 → 结果输出
```

## 三、功能详细设计

### 3.1 主界面模块

#### 3.1.1 系统状态监控
- **功能描述**：实时展示节能策略模拟系统的运行状态和核心指标
- **设计要点**：
  - 模拟引擎状态监控
  - 策略模板数量统计
  - 历史记录数量统计
  - 数据更新时间展示

- **实现方式**：
  ```html
  <el-card shadow="hover" class="system-status-card">
    <div slot="header" class="card-header">
      <span><i class="fa fa-server"></i> 系统状态监控</span>
    </div>
    <el-row :gutter="20">
      <el-col :xs="24" :sm="12" :md="6">
        <div class="status-item">
          <div class="status-icon success">
            <i class="fa fa-check-circle"></i>
          </div>
          <div class="status-info">
            <div class="status-value">运行正常</div>
            <div class="status-label">模拟引擎</div>
          </div>
        </div>
      </el-col>
      <!-- 其他状态项 -->
    </el-row>
  </el-card>
  ```

#### 3.1.2 标签页导航
- **功能描述**：提供各功能模块间的快速切换
- **设计要点**：
  - 标签页标题设计
  - 图标与文字组合
  - 选中状态样式
  - 内容区域动态加载

- **实现方式**：
  ```html
  <el-tabs v-model="activeTab" type="card" @tab-click="handleTabClick">
    <el-tab-pane label="策略推荐" name="recommendation">
      <span slot="label">
        <i class="fa fa-lightbulb-o"></i> 策略推荐
      </span>
      <StrategyRecommendation />
    </el-tab-pane>
    <!-- 其他标签页 -->
  </el-tabs>
  ```

### 3.2 策略推荐模块

#### 3.2.1 条件设置
- **功能描述**：收集用户对节能策略的需求和偏好
- **设计要点**：
  - 车站类型选择
  - 用能特点选择
  - 预算范围设置
  - 实施周期选择
  - 优先级设置

- **数据模型**：
  ```javascript
  recommendationForm: {
    stationType: 'large', // 车站类型
    energyFeature: 'cooling', // 用能特点
    budgetRange: 'medium', // 预算范围
    savingGoal: 'medium', // 节能目标
    implementationCycle: 'medium', // 实施周期
    climateZone: 'hot-summer-cold-winter', // 气候区域
    passengerFlow: 'high', // 客流情况
    equipmentStatus: 'normal', // 设备状态
    priorities: [] // 优先级
  }
  ```

#### 3.2.2 推荐算法
- **功能描述**：基于用户输入条件和历史数据，推荐合适的节能策略
- **设计要点**：
  - 匹配度计算算法
  - 加权评分机制
  - 多策略排序
  - 置信度评估

- **算法实现**：
  ```javascript
  calculateMatchScore(strategy) {
    let score = 0;
    const criteria = this.getStrategyCriteria(strategy);
    const form = this.recommendationForm;
    
    criteria.forEach(criterion => {
      if (criterion.values) {
        if (criterion.values.includes(form[criterion.field])) {
          score += criterion.weight;
        }
      } else if (criterion.value === form[criterion.field]) {
        score += criterion.weight;
      }
    });
    
    // 添加优先级奖励
    score += this.calculatePriorityBonus(strategy);
    
    return Math.min(100, Math.max(0, score));
  }
  ```

#### 3.2.3 结果展示
- **功能描述**：以卡片形式展示推荐策略的详细信息
- **设计要点**：
  - 策略基本信息
  - 节能效果展示
  - 投资回报分析
  - 匹配度可视化
  - 操作按钮设计

- **实现方式**：
  ```html
  <div v-for="strategy in filteredRecommendations" :key="strategy.id" class="strategy-card">
    <div class="card-badge">推荐</div>
    <div class="card-body">
      <h3 class="strategy-name">{{ strategy.name }}</h3>
      <p class="strategy-desc">{{ strategy.description }}</p>
      <div class="strategy-metrics">
        <div class="metric-row">
          <span class="metric-label">预计节能率</span>
          <span class="metric-value highlight">{{ strategy.savingsRate }}%</span>
        </div>
        <div class="metric-row">
          <span class="metric-label">投资成本</span>
          <span class="metric-value">¥{{ strategy.investment }}万</span>
        </div>
        <div class="metric-row">
          <span class="metric-label">回收周期</span>
          <span class="metric-value">{{ strategy.paybackPeriod }}年</span>
        </div>
        <div class="metric-row">
          <span class="metric-label">匹配度</span>
          <span class="metric-value">{{ strategy.matchScore }}%</span>
        </div>
      </div>
      <div class="strategy-match">
        <div class="match-indicator">
          <div class="match-bar">
            <div class="match-fill" :style="{ width: strategy.matchScore + '%' }"></div>
          </div>
          <div class="match-text">匹配度: {{ strategy.matchScore }}%</div>
        </div>
      </div>
    </div>
    <div class="card-footer">
      <el-button size="small" @click="handleViewDetail(strategy)">查看详情</el-button>
      <el-button type="primary" size="small" @click="handleApplyStrategy(strategy)">应用策略</el-button>
    </div>
  </div>
  ```

### 3.3 模板管理模块

#### 3.3.1 模板分类
- **功能描述**：提供不同类型节能策略模板的分类导航
- **设计要点**：
  - 分类选项设计
  - 分类图标设计
  - 选中状态样式
  - 分类筛选逻辑

- **分类结构**：
  - 全部模板
  - 照明系统
  - 空调系统
  - 通风系统
  - 可再生能源
  - 智能控制

#### 3.3.2 模板搜索
- **功能描述**：支持按名称和描述搜索策略模板
- **设计要点**：
  - 搜索输入框设计
  - 搜索图标位置
  - 清空按钮设计
  - 搜索结果高亮

#### 3.3.3 模板操作
- **功能描述**：提供模板的创建、编辑、应用和删除操作
- **设计要点**：
  - 模板创建流程
  - 模板编辑界面
  - 模板应用机制
  - 模板删除确认

- **实现方式**：
  ```html
  <el-button type="primary" size="small" @click="handleCreateTemplate">
    <i class="fa fa-plus"></i> 创建模板
  </el-button>
  <el-button size="small" @click="handleImportTemplate">
    <i class="fa fa-upload"></i> 导入
  </el-button>
  ```

### 3.4 策略组合模块

#### 3.4.1 多策略组合
- **功能描述**：支持将多个策略组合成综合方案
- **设计要点**：
  - 策略选择界面
  - 组合方案可视化
  - 策略冲突检测
  - 组合优化建议

#### 3.4.2 组合效果分析
- **功能描述**：分析组合策略的总体效果
- **设计要点**：
  - 节能效果叠加
  - 投资成本累计
  - 回收期计算
  - 效果对比图表

#### 3.4.3 参数调整
- **功能描述**：允许用户调整组合策略的参数
- **设计要点**：
  - 参数调节界面
  - 参数联动关系
  - 实时效果预览
  - 参数组合验证

### 3.5 实时模拟模块

#### 3.5.1 模拟引擎
- **功能描述**：基于选定策略执行能耗模拟
- **设计要点**：
  - 模拟算法设计
  - 模拟参数设置
  - 模拟进度展示
  - 模拟结果生成

#### 3.5.2 实时数据
- **功能描述**：展示模拟过程中的实时数据
- **设计要点**：
  - 数据更新频率
  - 数据可视化图表
  - 数据筛选功能
  - 数据导出功能

#### 3.5.3 模拟结果
- **功能描述**：展示模拟完成后的详细结果
- **设计要点**：
  - 结果分类展示
  - 趋势图表设计
  - 结果对比功能
  - 结果下载功能

### 3.6 历史记录模块

#### 3.6.1 记录查询
- **功能描述**：提供历史策略模拟记录的查询功能
- **设计要点**：
  - 查询条件设置
  - 记录列表展示
  - 分页功能设计
  - 记录详情查看

#### 3.6.2 记录分析
- **功能描述**：对历史记录进行分析和统计
- **设计要点**：
  - 趋势分析图表
  - 策略效果排名
  - 节能效果统计
  - 投资回报分析

#### 3.6.3 记录导出
- **功能描述**：支持将历史记录导出为报告
- **设计要点**：
  - 导出格式选择
  - 导出内容配置
  - 导出进度显示
  - 导出结果下载

## 四、数据结构设计

### 4.1 策略模板数据模型
```javascript
// 策略模板
{
  id: 'sys-001', // 模板ID
  name: 'LED照明替换方案', // 模板名称
  description: '全面更换为高效率LED灯具，配合智能调光系统', // 模板描述
  category: 'lighting', // 分类
  type: 'system', // 类型：system(系统预设)/custom(自定义)
  icon: 'fa-lightbulb-o', // 图标
  color: '#F7C94B', // 颜色
  expectedSavings: 5, // 预计节能率(%)
  params: { // 参数配置
    lightingType: 'ledReplacement',
    sensitivity: 80,
    delayTime: 5
  },
  expectedInvestment: 1200000, // 预计投资(元)
  expectedPaybackPeriod: 2.5, // 预计回收期(年)
  createTime: '2025-01-15' // 创建时间(自定义模板)
}
```

### 4.2 推荐策略数据模型
```javascript
// 推荐策略
{
  id: 'rec-001', // 推荐ID
  name: 'LED照明改造', // 策略名称
  category: '照明节能', // 策略类别
  description: '采用高效率LED灯具替换传统照明设备，配合智能控制系统，实现节能效果', // 策略描述
  savingsRate: 5.2, // 节能率(%)
  investment: 120, // 投资成本(万元)
  paybackPeriod: 2.5, // 回收周期(年)
  confidence: 85, // 置信度(%)
  matchScore: 92, // 匹配度(%)
  parameters: [ // 参数配置
    {
      name: '灯具替换率',
      label: '灯具替换率',
      value: 80,
      min: 50,
      max: 100,
      step: 5,
      unit: '%',
      editable: true,
      marks: { 50: '50%', 100: '100%' }
    },
    // 更多参数
  ],
  conditions: [ // 适用条件
    { label: '现有照明能耗占比 > 15%', icon: 'fa-check-circle', met: true },
    { label: '灯具使用年限 > 5年', icon: 'fa-check-circle', met: true },
    { label: '具备智能控制系统接口', icon: 'fa-exclamation-circle', met: false }
  ],
  effects: { // 预期效果
    energySaving: 180, // 年节能量(万kWh)
    costSaving: 180, // 年节约费用(万元)
    co2Reduction: 900 // 年减少CO2排放(吨)
  }
}
```

### 4.3 策略组合数据模型
```javascript
// 策略组合
{
  id: 'comb-001', // 组合ID
  name: '综合节能改造方案', // 组合名称
  strategies: [ // 包含的策略
    {
      id: 'rec-001',
      name: 'LED照明改造',
      parameters: [
        { name: '灯具替换率', value: 80, unit: '%' },
        { name: '智能控制覆盖率', value: 60, unit: '%' }
      ]
    },
    {
      id: 'rec-002',
      name: '空调系统优化',
      parameters: [
        { name: '温度设定优化', value: 24, unit: '°C' },
        { name: '新风量优化', value: 15, unit: '%' }
      ]
    }
    // 更多策略
  ],
  totalSavingsRate: 14.5, // 总节能率(%)
  totalInvestment: 380, // 总投资(万元)
  totalPaybackPeriod: 3.2, // 总回收期(年)
  conflictAnalysis: { // 冲突分析
    hasConflict: false,
    conflicts: [] // 冲突详情
  },
  optimization: { // 优化建议
    suggestion: '建议优化照明与空调策略的参数配置以提高整体效果',
    parameters: [
      { strategy: 'LED照明改造', param: '智能控制覆盖率', current: 60, recommended: 75 }
    ]
  },
  createdTime: '2025-03-20', // 创建时间
  updatedTime: '2025-03-25' // 更新时间
}
```

### 4.4 模拟结果数据模型
```javascript
// 模拟结果
{
  id: 'sim-001', // 模拟ID
  strategyId: 'comb-001', // 策略组合ID
  name: '综合节能改造方案', // 模拟名称
  startDate: '2025-04-01', // 模拟开始日期
  duration: 365, // 模拟时长(天)
  interval: 1, // 数据间隔(小时)
  parameters: { // 模拟参数
    baseEnergyConsumption: 5000, // 基准能耗(kWh/天)
    weatherData: 'typical', // 天气数据
    passengerFlow: 'typical', // 客流数据
    // 更多参数
  },
  results: { // 模拟结果
    dailyEnergyConsumption: [ // 日能耗数据
      { date: '2025-04-01', value: 4650 },
      { date: '2025-04-02', value: 4720 },
      // 更多数据
    ],
    energySaving: { // 节能效果
      daily: 350, // 日节能量(kWh)
      monthly: 10500, // 月节能量(kWh)
      yearly: 127750, // 年节能量(kWh)
      percentage: 7 // 节能率(%)
    },
    costSaving: { // 费用节约
      daily: 350, // 日节约费用(元)
      monthly: 10500, // 月节约费用(元)
      yearly: 127750 // 年节约费用(元)
    },
    co2Reduction: { // CO2减排
      daily: 1.75, // 日减排量(吨)
      monthly: 52.5, // 月减排量(吨)
      yearly: 638.75 // 年减排量(吨)
    },
    peakLoadReduction: { // 负荷削减
      maxReduction: 350, // 最大削减量(kW)
      averageReduction: 280, // 平均削减量(kW)
      reductionPercentage: 14 // 削减比例(%)
    }
  },
  charts: { // 图表数据
    energyComparison: { // 能耗对比图表数据
      labels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],
      beforeData: [4500, 4400, 4300, 5000, 5500, 6000, 6500, 6300, 5700, 5100, 4700, 4600],
      afterData: [3825, 3740, 3655, 4250, 4675, 5100, 5525, 5355, 4845, 4335, 3995, 3910]
    },
    costSavingTrend: { // 费用节约趋势数据
      labels: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'],
      data: [675, 660, 645, 750, 825, 900, 975, 945, 855, 765, 705, 690]
    }
  },
  createdTime: '2025-03-28' // 创建时间
}
```

## 五、界面交互设计

### 5.1 策略推荐交互流程
```
[进入策略推荐] → [设置推荐条件] → [获取推荐结果] → [查看策略详情] → [应用策略]
```

### 5.2 模板管理交互流程
```
[进入模板管理] → [选择模板分类] → [搜索/筛选模板] → [选择模板] → [应用/编辑模板]
```

### 5.3 策略组合交互流程
```
[进入策略组合] → [添加策略] → [调整策略参数] → [分析组合效果] → [保存组合方案]
```

### 5.4 实时模拟交互流程
```
[进入实时模拟] → [选择策略] → [设置模拟参数] → [执行模拟] → [查看模拟结果] → [导出结果]
```

### 5.5 历史记录交互流程
```
[进入历史记录] → [设置查询条件] → [查看记录列表] → [查看记录详情] → [导出记录]
```

## 六、异常处理机制

### 6.1 输入验证
- 策略参数范围检查
- 策略组合冲突检测
- 模拟参数合理性验证

### 6.2 错误提示
- 用户友好的错误信息
- 错误原因说明
- 解决方案建议

### 6.3 异常恢复
- 模拟中断恢复机制
- 数据丢失恢复策略
- 系统异常处理流程

## 七、性能优化设计

### 7.1 数据处理优化
- 模拟算法优化
- 大量数据分页加载
- 图表渲染性能优化

### 7.2 用户体验优化
- 加载状态提示
- 操作结果反馈
- 响应式界面适配

### 7.3 系统资源优化
- 内存使用优化
- CPU占用控制
- 缓存策略设计

## 八、安全设计

### 8.1 数据安全
- 敏感数据加密存储
- 数据传输安全控制
- 用户权限管理

### 8.2 系统安全
- SQL注入防护
- XSS攻击防范
- CSRF攻击防护

### 8.3 访问控制
- 角色权限管理
- 功能访问控制
- 操作日志记录

## 九、扩展性设计

### 9.1 功能扩展
- 新增策略类型
- 扩展模拟算法
- 增加数据源

### 9.2 数据扩展
- 历史数据归档
- 数据迁移机制
- 存储空间优化

### 9.3 系统扩展
- 微服务架构支持
- 第三方系统集成
- 云部署支持

## 十、测试策略

### 10.1 单元测试
- 算法逻辑测试
- 数据处理测试
- 组件功能测试

### 10.2 集成测试
- 模块间交互测试
- 数据流测试
- 端到端流程测试

### 10.3 性能测试
- 模拟性能测试
- 大数据量处理测试
- 并发访问测试

### 10.4 用户体验测试
- 界面交互测试
- 响应速度测试
- 兼容性测试

## 十一、部署与运维

### 11.1 部署方案
- 前后端分离部署
- 容器化部署
- 负载均衡配置

### 11.2 运维监控
- 系统性能监控
- 错误日志记录
- 用户行为分析

### 11.3 数据备份
- 定期数据备份
- 备份数据验证
- 灾难恢复预案

## 十二、文档与培训

### 12.1 技术文档
- 架构设计文档
- 接口设计文档
- 数据库设计文档

### 12.2 用户文档
- 功能使用指南
- 常见问题解答
- 操作视频教程

### 12.3 培训方案
- 管理员培训
- 最终用户培训
- 维护人员培训